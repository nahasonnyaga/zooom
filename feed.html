<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Threads 100 Clone - Feed</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: #f7f7fa;
      color: #20232a;
    }
    nav {
      position: sticky;
      top: 0;
      z-index: 100;
      background: #fff;
      border-bottom: 1px solid #eee;
      padding: 0.75rem 1.2rem;
      display: flex;
      gap: 1.5rem;
      font-size: 1.13rem;
      font-weight: 500;
    }
    nav a {
      color: #3742fa;
      text-decoration: none;
      padding: 0.2em 0.6em;
      border-radius: 6px;
      transition: background 0.15s;
    }
    nav a:hover, nav a:focus {
      background: #eef3fc;
      color: #222;
      outline: none;
    }
    .login-status {
      position: absolute;
      right: 1.5em;
      top: 1em;
      font-size: 1rem;
      color: #444;
      display: flex;
      align-items: center;
      gap: 0.7rem;
    }
    .login-status button {
      padding: 0.28em 1.1em;
      font-size: 1rem;
      background: #3742fa;
      color: #fff;
      border: none;
      border-radius: 7px;
      cursor: pointer;
      transition: background 0.13s;
    }
    .login-status .logged-in {
      color: #27ae60;
      font-weight: bold;
    }
    .feed {
      width: 100vw;
      max-width: 100vw;
      margin: 0 auto;
      padding: 1rem 0.5rem 2rem 0.5rem;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      gap: 2.5rem;
    }
    .thread-card, .reply-card {
      background: #fff;
      margin-bottom: 1rem;
      padding: 2.1rem 1.4rem;
      border-radius: 14px;
      box-shadow: 0 1px 12px #0001;
      font-size: 2.1rem;
      line-height: 1.8;
      transition: box-shadow 0.15s;
    }
    .thread-card:hover, .reply-card:hover {
      box-shadow: 0 4px 20px #0002;
    }
    .thread-card a {
      color: inherit;
      text-decoration: none;
      font-weight: 700;
      word-break: break-word;
      font-size: 2.2rem;
    }
    .thread-card small, .reply-card small {
      color: #888;
      font-size: 1.2rem;
      display: block;
      margin-top: 0.2em;
      margin-bottom: 0.7em;
      letter-spacing: 0.2px;
    }
    .thread-actions {
      display: flex;
      align-items: center;
      gap: 1.2rem;
      margin-top: 0.85rem;
      font-size: 1.2rem;
      padding: 0 0.3rem;
    }
    .action-btn {
      background: none;
      border: none;
      box-shadow: none;
      padding: 0.25rem 0.6rem;
      font-size: 1.45rem;
      color: #606770;
      border-radius: 50%;
      transition: background 0.13s, color 0.17s;
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 2.1em;
      min-height: 2.1em;
    }
    .action-btn:active,
    .action-btn:focus,
    .action-btn:hover {
      background: #f0f2f5;
      color: #222;
      outline: none;
    }
    .like-btn.liked {
      color: #e74c3c;
    }
    .bookmark-btn.bookmarked {
      color: #222;
    }
    .retweet-btn.retweeted {
      color: #27ae60;
    }
    .like-count, .retweet-count {
      font-size: 1.18rem;
      color: #606770;
      margin: 0 0.18em 0 0.18em;
      font-weight: 400;
      letter-spacing: 0;
      min-width: unset;
      display: inline;
      text-align: left;
      vertical-align: middle;
    }
    .reply-section {
      margin-left: 0;
      margin-top: 1.6rem;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
    }
    .reply-card {
      background: #f7f7fa;
      border: 1px solid #eee;
      font-size: 1.45rem;
      padding: 1.2em 1.9em;
      border-radius: 11px;
      margin-bottom: 0;
      box-shadow: none;
    }
    .thread-card:focus-within, .reply-card:focus-within {
      outline: 2px solid #3742fa;
      outline-offset: 2px;
    }
    .comment-form {
      display: flex;
      flex-direction: row;
      align-items: flex-start;
      gap: 0.6rem;
      margin-top: 1rem;
    }
    .comment-form textarea {
      flex: 1;
      padding: 0.7em 1em;
      font-size: 1.1rem;
      border: 1px solid #bbb;
      border-radius: 9px;
      resize: vertical;
      min-height: 2.2em;
      background: #fff;
      font-family: inherit;
      transition: border 0.15s;
    }
    .comment-form textarea:focus {
      border: 1.5px solid #3742fa;
      outline: none;
    }
    .comment-form button {
      padding: 0.6em 1.2em;
      background: #3742fa;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 1.06rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.17s;
    }
    .comment-form button:disabled {
      background: #bbb;
      cursor: not-allowed;
    }
    @media (max-width: 600px) {
      nav {
        font-size: 1.25rem;
        gap: 0.4rem;
        padding: 0.75rem 0.4rem;
      }
      .feed {
        padding: 0.6rem 0.1rem 1.2rem 0.1rem;
        gap: 1.7rem;
      }
      .thread-card, .reply-card {
        padding: 1.1rem 0.6rem;
        font-size: 1.35rem;
        border-radius: 10px;
      }
      .reply-card {
        padding: 0.7em 1.1em;
        font-size: 1.1rem;
        border-radius: 8px;
      }
      .thread-card a {
        font-size: 1.5rem;
      }
      .thread-actions {
        font-size: 1.06rem;
        gap: 0.7rem;
      }
      .action-btn {
        font-size: 1.1rem;
        padding: 0.08rem 0.32rem;
        min-width: 1.6em;
        min-height: 1.6em;
      }
      .like-count, .retweet-count {
        font-size: 0.95rem;
      }
      .comment-form textarea {
        font-size: 1rem;
        padding: 0.5em 0.7em;
      }
      .comment-form button {
        font-size: 0.96rem;
        padding: 0.5em 0.7em;
      }
      .login-status {
        right: 0.5em;
        top: 0.5em;
        font-size: 0.96rem;
      }
    }
    @media (hover: none) and (pointer: coarse) {
      .action-btn {
        padding: 0.75em 1.3em;
      }
    }
  </style>
</head>
<body>
  <!-- Mock login status -->
  <div class="login-status" id="loginStatus">
    <span id="loginText">Not logged in</span>
    <button id="loginBtn" onclick="toggleLogin()">Login</button>
  </div>

  <!-- Navbar -->
  <nav>
    <a href="index.html" aria-current="page">Feed</a>
    <a href="profile.html">Profile</a>
    <a href="post.html">New Thread</a>
  </nav>

  <main class="feed" aria-label="Threads feed">

    <!-- MOCK THREAD 1 -->
    <section class="thread-card" tabindex="0" aria-label="Thread by alice: Whatâ€™s your favorite open source project this year?">
      <a href="thread.html?id=1">
        <p>Whatâ€™s your favorite open source project this year? ðŸš€</p>
      </a>
      <small>Posted by alice â€¢ 2h ago</small>
      <div class="thread-actions" aria-label="actions">
        <button class="action-btn like-btn" title="Like" aria-label="Like" onclick="handleAction(event, 'like')">
          &#10084;
        </button>
        <span class="like-count" aria-label="5 likes">5</span>
        <button class="action-btn retweet-btn" title="Repost" aria-label="Repost" onclick="handleAction(event, 'repost')">
          &#8635;
        </button>
        <span class="retweet-count" aria-label="2 reposts">2</span>
        <button class="action-btn bookmark-btn" title="Bookmark" aria-label="Bookmark" onclick="handleAction(event, 'bookmark')">
          &#128278;
        </button>
      </div>
      <!-- Replies to Thread 1 -->
      <div class="reply-section" aria-label="Replies">
        <div class="reply-card" tabindex="0" aria-label="Reply by bob">
          <p>I love Supabase! Super easy to use! ðŸ”¥</p>
          <small>bob â€¢ 1h ago</small>
        </div>
        <div class="reply-card" tabindex="0" aria-label="Reply by charlie">
          <p>Definitely Astro, itâ€™s a game changer for web dev.</p>
          <small>charlie â€¢ 30m ago</small>
        </div>
      </div>
      <!-- Comment form for Thread 1 -->
      <form class="comment-form" aria-label="Add a reply" onsubmit="return addReply(event, 1)">
        <textarea name="reply" placeholder="Reply to this thread..." required aria-label="Reply"></textarea>
        <button type="submit">Reply</button>
      </form>
    </section>

    <!-- MOCK THREAD 2 -->
    <section class="thread-card" tabindex="0" aria-label="Thread by dana: Just shipped my first project using this template.">
      <a href="thread.html?id=2">
        <p>Just shipped my first project using this template. Thanks for making it so simple!</p>
      </a>
      <small>Posted by dana â€¢ 30m ago</small>
      <div class="thread-actions" aria-label="actions">
        <button class="action-btn like-btn" title="Like" aria-label="Like" onclick="handleAction(event, 'like')">
          &#10084;
        </button>
        <span class="like-count" aria-label="9 likes">9</span>
        <button class="action-btn retweet-btn" title="Repost" aria-label="Repost" onclick="handleAction(event, 'repost')">
          &#8635;
        </button>
        <span class="retweet-count" aria-label="1 repost">1</span>
        <button class="action-btn bookmark-btn" title="Bookmark" aria-label="Bookmark" onclick="handleAction(event, 'bookmark')">
          &#128278;
        </button>
      </div>
      <!-- Replies to Thread 2 -->
      <div class="reply-section" aria-label="Replies">
        <div class="reply-card" tabindex="0" aria-label="Reply by alice">
          <p>Congrats! Would love to see your project.</p>
          <small>alice â€¢ 10m ago</small>
        </div>
      </div>
      <!-- Comment form for Thread 2 -->
      <form class="comment-form" aria-label="Add a reply" onsubmit="return addReply(event, 2)">
        <textarea name="reply" placeholder="Reply to this thread..." required aria-label="Reply"></textarea>
        <button type="submit">Reply</button>
      </form>
    </section>

    <!-- MOCK THREAD 3 -->
    <section class="thread-card" tabindex="0" aria-label="Thread by emma: Any tips for learning CSS Grid quickly?">
      <a href="thread.html?id=3">
        <p>Any tips for learning CSS Grid quickly?</p>
      </a>
      <small>Posted by emma â€¢ 10m ago</small>
      <div class="thread-actions" aria-label="actions">
        <button class="action-btn like-btn" title="Like" aria-label="Like" onclick="handleAction(event, 'like')">
          &#10084;
        </button>
        <span class="like-count" aria-label="3 likes">3</span>
        <button class="action-btn retweet-btn" title="Repost" aria-label="Repost" onclick="handleAction(event, 'repost')">
          &#8635;
        </button>
        <span class="retweet-count" aria-label="0 reposts">0</span>
        <button class="action-btn bookmark-btn" title="Bookmark" aria-label="Bookmark" onclick="handleAction(event, 'bookmark')">
          &#128278;
        </button>
      </div>
      <!-- Replies to Thread 3 -->
      <div class="reply-section" aria-label="Replies"></div>
      <!-- Comment form for Thread 3 -->
      <form class="comment-form" aria-label="Add a reply" onsubmit="return addReply(event, 3)">
        <textarea name="reply" placeholder="Reply to this thread..." required aria-label="Reply"></textarea>
        <button type="submit">Reply</button>
      </form>
    </section>

  </main>
  <script>
    /**
     * Check login state using localStorage.
     * In real production, this should be replaced with secure authentication logic.
     */
    let loggedIn = false;
    let username = '';

    function getLoginState() {
      // Simulate persistent login via localStorage.
      const user = localStorage.getItem('threadsUser');
      if (user) {
        loggedIn = true;
        username = user;
      } else {
        loggedIn = false;
        username = '';
      }
    }

    function updateLoginUI() {
      const loginText = document.getElementById('loginText');
      const loginBtn = document.getElementById('loginBtn');
      if (loggedIn) {
        loginText.innerHTML = `<span class="logged-in">Logged in as <b>${username}</b></span>`;
        loginBtn.textContent = 'Logout';
      } else {
        loginText.textContent = 'Not logged in';
        loginBtn.textContent = 'Login';
      }
    }

    function toggleLogin() {
      if (!loggedIn) {
        // Simulate redirect to signin.html
        window.location.href = 'signin.html';
      } else {
        localStorage.removeItem('threadsUser');
        loggedIn = false;
        username = '';
        updateLoginUI();
      }
    }

    function requireLogin(redirectTo = 'signin.html') {
      if (!loggedIn) {
        window.location.href = redirectTo;
        return false;
      }
      return true;
    }

    // Simple username randomizer for mock replies (kept just for demo fallback)
    const usernames = ['you', 'alex', 'sandy', 'jordan', 'casey'];

    function getRelativeTime(date) {
      // Always returns "just now" for demo; could be improved with date math.
      return 'just now';
    }

    function addReply(event, threadId) {
      event.preventDefault();
      if (!requireLogin()) return false;

      const form = event.target;
      const textarea = form.querySelector('textarea');
      const replyText = textarea.value.trim();
      if (!replyText) return false;

      // Find the reply section corresponding to this thread
      const threadSection = form.closest('.thread-card');
      const replySection = threadSection.querySelector('.reply-section');
      // Use logged in user for demo; in production, use real user data
      const user = username || usernames[Math.floor(Math.random() * usernames.length)];
      // Create reply card
      const replyCard = document.createElement('div');
      replyCard.className = 'reply-card';
      replyCard.tabIndex = 0;
      replyCard.setAttribute('aria-label', `Reply by ${user}`);
      replyCard.innerHTML = `
        <p>${escapeHtml(replyText)}</p>
        <small>${user} â€¢ ${getRelativeTime(new Date())}</small>
      `;
      replySection.appendChild(replyCard);
      textarea.value = '';
      return false;
    }

    function escapeHtml(text) {
      var div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function handleAction(event, actionType) {
      if (!requireLogin()) {
        event.preventDefault();
        return false;
      }
      // Optionally, you can proceed to toggle UI for like, repost, bookmark
      // For demo, we just show a quick visual toggle
      const btn = event.currentTarget;
      switch (actionType) {
        case 'like':
          btn.classList.toggle('liked');
          break;
        case 'repost':
          btn.classList.toggle('retweeted');
          break;
        case 'bookmark':
          btn.classList.toggle('bookmarked');
          break;
      }
    }

    // On page load:
    getLoginState();
    updateLoginUI();

    // Redirect to signin.html if not logged in
    if (!loggedIn) {
      // Optionally, for some pages you might want signup.html instead
      window.location.href = 'signin.html';
    }
  </script>
</body>
</html>
